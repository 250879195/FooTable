/*!
 * FooTable - Awesome Responsive Tables
 * Version : 0.5
 * http://themergency.com/footable
 *
 * Requires jQuery - http://jquery.com/
 *
 * Copyright 2012 Steven Usher & Brad Vincent
 * Released under the MIT license
 * You are free to use FooTable in commercial projects as long as this copyright header is left intact.
 *
 * Date: 22 Apr 2013
 */
(function(t,e,undefined){function a(){var t=this;t.id=null,t.busy=!1,t.start=function(e,a){t.busy||(t.stop(),t.id=setTimeout(function(){e(),t.id=null,t.busy=!1},a),t.busy=!0)},t.stop=function(){null!==t.id&&(clearTimeout(t.id),t.id=null,t.busy=!1)}}function o(o,i,n){var r=this;r.id=n,r.table=o,r.options=i,r.breakpoints=[],r.breakpointNames="",r.columns={};var l=r.options,d=l.classes,s=0;return r.timers={resize:new a,register:function(t){return r.timers[t]=new a,r.timers[t]}},e.footable.plugins.init(r),r.init=function(){var a=t(e),o=t(r.table);if(o.hasClass(d.loaded))return r.raise("footable_already_initialized"),undefined;o.addClass(d.loading),o.find(l.columnDataSelector).each(function(){var t=r.getColumnData(this);r.columns[t.index]=t});for(var i in l.breakpoints)r.breakpoints.push({name:i,width:l.breakpoints[i]}),r.breakpointNames+=i+" ";r.breakpoints.sort(function(t,e){return t.width-e.width}),r.raise("footable_initializing"),o.bind("footable_initialized",function(){o.removeData("footable_info"),r.addRowToggle(),r.bindToggleSelectors(),r.setColumnClasses(),r.resize(),o.removeClass(d.loading),o.addClass(d.loaded).addClass(d.main)}),o.bind("footable_resize",function(){r.resize()}),a.bind("resize.footable",function(){r.timers.resize.stop(),r.timers.resize.start(function(){r.resize()},l.delay)}),r.raise("footable_initialized")},r.addRowToggle=function(){var e=!1;$table=t(r.table);for(var a in r.columns){var o=r.columns[a];if(o.toggle){e=!0;var i="> tbody > tr:not(.footable-row-detail) > td:nth-child("+(parseInt(o.index,10)+1)+")";return $table.find(i).not(".footable-cell-detail").prepend(t("<span />").addClass(d.toggle)),undefined}}e||$table.find("> tbody > tr:not(.footable-row-detail) > td:first-child").not(".footable-cell-detail").prepend(t("<span />").addClass(d.toggle))},r.setColumnClasses=function(){$table=t(r.table);for(var e in r.columns){var a=r.columns[e];if(null!==a.className){var o="",i=!0;t.each(a.matches,function(t,e){i||(o+=", "),o+="> tbody > tr:not(.footable-row-detail) > td:nth-child("+(parseInt(e,10)+1)+")",i=!1}),$table.find(o).not(".footable-cell-detail").addClass(a.className)}}},r.bindToggleSelectors=function(){var e=t(r.table);e.find(l.toggleSelector).unbind("click.footable").bind("click.footable",function(a){if(e.is(".breakpoint")&&t(a.target).is("td,.footable-toggle")){var o=t(this).is("tr")?t(this):t(this).parents("tr:first");r.toggleDetail(o.get(0))}})},r.parse=function(t,e){var a=l.parsers[e.type]||l.parsers.alpha;return a(t)},r.getColumnData=function(e){var a=t(e),o=a.data("hide"),i=a.index();o=o||"",o=o.split(",");var n={index:i,hide:{},type:a.data("type")||"alpha",name:a.data("name")||t.trim(a.text()),ignore:a.data("ignore")||!1,toggle:a.data("toggle")||!1,className:a.data("class")||null,matches:[],names:{},group:a.data("group")||null,groupName:null};if(null!==n.group){var d=t(r.table).find('> thead > tr.footable-group-row > th[data-group="'+n.group+'"], > thead > tr.footable-group-row > td[data-group="'+n.group+'"]').first();n.groupName=r.parse(d,{type:"alpha"})}var u=parseInt(a.prev().attr("colspan")||0,10);s+=u>1?u-1:0;var f=parseInt(a.attr("colspan")||0,10),h=n.index+s;if(f>1){var c=a.data("names");c=c||"",c=c.split(",");for(var p=0;f>p;p++)n.matches.push(p+h),c.length>p&&(n.names[p+h]=c[p])}else n.matches.push(h);n.hide["default"]="all"===a.data("hide")||t.inArray("default",o)>=0;for(var b in l.breakpoints)n.hide[b]="all"===a.data("hide")||t.inArray(b,o)>=0;var g=r.raise("footable_column_data",{column:{data:n,th:e}});return g.column.data},r.getViewportWidth=function(){return window.innerWidth||(document.body?document.body.offsetWidth:0)},r.getViewportHeight=function(){return window.innerHeight||(document.body?document.body.offsetHeight:0)},r.calculateWidthAndHeight=function(t,e){return jQuery.isFunction(l.calculateWidthAndHeightOverride)?l.calculateWidthAndHeightOverride(t,e):(e.viewportWidth<e.width&&(e.width=e.viewportWidth),e.viewportHeight<e.height&&(e.height=e.viewportHeight),e)},r.hasBreakpointColumn=function(t){for(var e in r.columns)if(r.columns[e].hide[t]){if(r.columns[e].ignore)continue;return!0}return!1},r.resize=function(){var e=t(r.table),a={width:e.width(),height:e.height(),viewportWidth:r.getViewportWidth(),viewportHeight:r.getViewportHeight(),orientation:null};a.orientation=a.viewportWidth>a.viewportHeight?"landscape":"portrait",a=r.calculateWidthAndHeight(e,a);var o=e.data("footable_info");if(e.data("footable_info",a),r.raise("footable_resizing",{old:o,info:a}),!o||o&&o.width&&o.width!==a.width||o&&o.height&&o.height!==a.height){for(var i,n=null,l=0;r.breakpoints.length>l;l++)if(i=r.breakpoints[l],i&&i.width&&a.width<=i.width){n=i;break}var d=null===n?"default":n.name,s=r.hasBreakpointColumn(d);e.removeClass("default breakpoint").removeClass(r.breakpointNames).addClass(d+(s?" breakpoint":"")).find("> thead > tr:last-child > th").each(function(){var a=r.columns[t(this).index()],o="",i=!0;t.each(a.matches,function(t,e){i||(o+=", ");var a=e+1;o+="> tbody > tr:not(.footable-row-detail) > td:nth-child("+a+")",o+=", > tfoot > tr:not(.footable-row-detail) > td:nth-child("+a+")",o+=", > colgroup > col:nth-child("+a+")",i=!1}),o+=', > thead > tr[data-group-row="true"] > th[data-group="'+a.group+'"]';var n=e.find(o).add(this);if(a.hide[d]===!1?n.show():n.hide(),1===e.find("> thead > tr.footable-group-row").length){var l=e.find('> thead > tr:last-child > th[data-group="'+a.group+'"]:visible, > thead > tr:last-child > th[data-group="'+a.group+'"]:visible'),s=e.find('> thead > tr.footable-group-row > th[data-group="'+a.group+'"], > thead > tr.footable-group-row > td[data-group="'+a.group+'"]'),u=0;t.each(l,function(){u+=parseInt(t(this).attr("colspan")||1,10)}),u>0?s.attr("colspan",u).show():s.hide()}}).end().find("> tbody > tr.footable-detail-show").each(function(){r.createOrUpdateDetailRow(this)}),e.find("> tbody > tr.footable-detail-show:visible").each(function(){var e=t(this).next();e.hasClass("footable-row-detail")&&("default"!==d||s?e.show():e.hide())}),e.find("> thead > tr > th.footable-last-column, > tbody > tr > td.footable-last-column").removeClass("footable-last-column"),e.find("> thead > tr > th.footable-first-column, > tbody > tr > td.footable-first-column").removeClass("footable-first-column"),e.find("> thead > tr, > tbody > tr").find("> th:visible:last, > td:visible:last").addClass("footable-last-column").end().find("> th:visible:first, > td:visible:first").addClass("footable-first-column"),r.raise("footable_breakpoint_"+d,{info:a})}r.raise("footable_resized",{old:o,info:a})},r.toggleDetail=function(e){var a=t(e),o=r.createOrUpdateDetailRow(a.get(0)),i=a.next();!o&&i.is(":visible")?(a.removeClass("footable-detail-show"),i.hasClass("footable-row-detail")&&i.hide()):(a.addClass("footable-detail-show"),i.show())},r.getColumnFromTdIndex=function(e){var a=null;for(var o in r.columns)if(t.inArray(e,r.columns[o].matches)>=0){a=r.columns[o];break}return a},r.createOrUpdateDetailRow=function(e){var a,o=t(e),i=o.next(),n=[];if(o.is(":hidden"))return!1;if(r.raise("footable_rowdetailupdated",{row:o,detail:i}),o.find("> td:hidden").each(function(){var e=t(this).index(),a=r.getColumnFromTdIndex(e),o=a.name;return a.ignore===!0?!0:(e in a.names&&(o=a.names[e]),n.push({name:o,value:r.parse(this,a),display:t.trim(t(this).html()),group:a.group,groupName:a.groupName}),!0)}),0===n.length)return!1;var s=o.find("> td:visible").length,u=i.hasClass("footable-row-detail");return u||(i=t('<tr class="footable-row-detail"><td class="footable-cell-detail"><div class="'+d.detailInner+'"></div></td></tr>'),o.after(i)),i.find("> td:first").attr("colspan",s),a=i.find("."+d.detailInner).empty(),l.createDetail(a,n,l.createGroupedDetail,l.detailSeparator,d),!u},r.raise=function(e,a){a=a||{};var o={ft:r};t.extend(!0,o,a);var i=t.Event(e,o);return i.ft||t.extend(!0,i,o),t(r.table).trigger(i),i},r.init(),r}e.footable={options:{delay:100,breakpoints:{phone:480,tablet:1024},parsers:{alpha:function(e){return t(e).data("value")||t.trim(t(e).text())}},calculateWidthAndHeightOverride:null,toggleSelector:" > tbody > tr:not(.footable-row-detail)",columnDataSelector:"> thead > tr:last-child > th, > thead > tr:last-child > td",detailSeparator:":",createGroupedDetail:function(t){for(var e={_none:{name:null,data:[]}},a=0;t.length>a;a++){var o=t[a].group;null!==o?(o in e||(e[o]={name:t[a].groupName||t[a].group,data:[]}),e[o].data.push(t[a])):e._none.data.push(t[a])}return e},createDetail:function(t,e,a,o,i){var n=a(e);for(var r in n)if(0!==n[r].data.length){"_none"!==r&&t.append('<div class="'+i.detailInnerGroup+'">'+n[r].name+"</div>");for(var l=0;n[r].data.length>l;l++){var d=n[r].data[l].name?o:"";t.append('<div class="'+i.detailInnerRow+'"><div class="'+i.detailInnerName+'">'+n[r].data[l].name+d+'</div><div class="'+i.detailInnerValue+'">'+n[r].data[l].display+"</div></div>")}}},classes:{main:"footable",loading:"footable-loading",loaded:"footable-loaded",toggle:"footable-toggle",sorted:"footable-sorted",descending:"footable-sorted-desc",indicator:"footable-sort-indicator",detailInner:"footable-row-detail-inner",detailInnerRow:"footable-row-detail-row",detailInnerGroup:"footable-row-detail-group",detailInnerName:"footable-row-detail-name",detailInnerValue:"footable-row-detail-value"},debug:!1},version:{major:0,minor:5,toString:function(){return e.footable.version.major+"."+e.footable.version.minor},parse:function(t){return version=/(\d+)\.?(\d+)?\.?(\d+)?/.exec(t),{major:parseInt(version[1],10)||0,minor:parseInt(version[2],10)||0,patch:parseInt(version[3],10)||0}}},plugins:{_validate:function(a){return"string"!=typeof a.name?(e.footable.options.debug===!0&&console.error('Validation failed, plugin does not implement a string property called "name".',a),!1):t.isFunction(a.init)?(e.footable.options.debug===!0&&console.log('Validation succeeded for plugin "'+a.name+'".',a),!0):(e.footable.options.debug===!0&&console.error('Validation failed, plugin "'+a.name+'" does not implement a function called "init".',a),!1)},registered:[],register:function(a,o){e.footable.plugins._validate(a)&&(e.footable.plugins.registered.push(a),o!==undefined&&"object"==typeof o&&t.extend(!0,e.footable.options,o),e.footable.options.debug===!0&&console.log('Plugin "'+a.name+'" has been registered with the Foobox.',a))},init:function(t){for(var a=0;e.footable.plugins.registered.length>a;a++)try{e.footable.plugins.registered[a].init(t)}catch(o){e.footable.options.debug===!0&&console.error(o)}}}};var i=0;t.fn.footable=function(a){a=a||{};var n=t.extend(!0,{},e.footable.options,a);return this.each(function(){i++,this.footable=new o(this,n,i)})}})(jQuery,window);